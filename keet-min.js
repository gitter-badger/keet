!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Keet=t()}}(function(){return function r(a,s,l){function c(e,t){if(!s[e]){if(!a[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(u)return u(e,!0);var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var o=s[e]={exports:{}};a[e][0].call(o.exports,function(t){return c(a[e][1][t]||t)},o,o.exports,r,a,s,l)}return s[e].exports}for(var u="function"==typeof require&&require,t=0;t<l.length;t++)c(l[t]);return c}({1:[function(t,e){e.exports=function(o){var r=this;return this.__componentList__.map(function(t){if(r[t]){var e=r[t];e.IS_STUB=!0;var n=RegExp("(\\{\\{component:"+t+"\\}\\})","g"),i=e.render("asString");o=o.replace(n,r.__componentStub__[t]=i)}}),o}},{}],2:[function(t,e,n){var i=t("./tmplHandler"),o=t("./processEvent"),r=t("../utils").getId,a=t("../utils").testEvent,s=t("../utils").loopChilds,l=t("../utils").checkNodeAvailability,c=t("./strInterpreter"),u=t("./componentParse"),f=t("./modelParse"),p=t("./nodesVisibility"),d=t("morphdom"),h=function(){var n=this,t=r(this.el),e=y.call(this),i=[];this.IS_STUB?d(t,e.childNodes[0]):(e.id=this.el,d(t,e),s(i,e),i.map(function(t){t.remove()}),this.__componentList__.map(function(t){if(n[t]){var e=n[t];l(e,null,function(){!e.DID_MOUNT&&e.componentDidMount&&"function"==typeof e.componentDidMount&&(e.DID_MOUNT=!0,e.componentDidMount())},function(){e.DID_MOUNT&&e.componentDidUnMount&&"function"==typeof e.componentDidUnMount&&(e.DID_MOUNT=!1,e.componentDidUnMount())})}})),this.componentDidUpdate&&"function"==typeof this.componentDidUpdate&&this.componentDidUpdate(),m.status="ready"},m={ttl:0,status:"ready"},v=function(){if("pooling"===m.status);else{var t=this;m.status="pooling",m.ttl?(clearTimeout(m.ttl),m.ttl=setTimeout(function(){h.call(t)},0)):h.call(this),m.ttl=setTimeout(function(){m.ttl=0},100)}},_=function(t){var e=this;if(t<this.__stateList__.length){var n=this.__stateList__[t],i=this[n];if(void 0===i&&(i=c(n)),i&&Array.isArray(i)){var o=this[i[0]][i[1]];Object.defineProperty(this[i[0]],i[1],{enumerable:!1,configurable:!0,get:function(){return o},set:function(t){o=t,v.call(e)}})}else Object.defineProperty(this,n,{enumerable:!1,configurable:!0,get:function(){return i},set:function(t){i=t,v.call(e)}});_.call(this,++t)}},g=function(){_.call(this,0)},b=function(t){~this.__stateList__.indexOf(t)||(this.__stateList__=this.__stateList__.concat(t))},y=function(t){var e=document.createElement("div"),n=i.call(this,b.bind(this));return n=u.call(this,n),n=f.call(this,n),n=p.call(this,n),e.innerHTML=n,g.call(this),a(n)&&o.call(this,e),t&&v.call(this),e};n.genElement=y,n.setState=g,n.updateStateList=b},{"../utils":13,"./componentParse":1,"./modelParse":4,"./nodesVisibility":5,"./processEvent":7,"./strInterpreter":8,"./tmplHandler":10,morphdom:12}],3:[function(t,e){var s=t("./ternaryOps"),l="";e.exports=function(t,e){var n,i,o=t.match(/{{([^{}]+)}}/g);l=t;for(var r=0,a=o.length;r<a;r++)n=o[r].replace(/{{([^{}]+)}}/g,"$1"),i=s.call(e,n),l=l.replace("{{"+n+"}}",i?i.value:e[n]);return l}},{"./ternaryOps":9}],4:[function(t,e){var s=t("./genModelTemplate");e.exports=function(r){var a=this;return this.__modelList__.map(function(t){if(a[t]){var e=RegExp("(\\{\\{model:"+t+"\\}\\})(.*?)(\\{\\{\\/model:"+t+"\\}\\})"),n=r.match(e);if(n){var i=a.base.match(e),o="";a[t].list.map(function(t){o+=s.call(a,i[2],t)}),r=r.replace(n[2],o)}}r=(r=r.replace("{{model:"+t+"}}","")).replace("{{/model:"+t+"}}","")}),r}},{"./genModelTemplate":3}],5:[function(t,e){e.exports=function(o){var r=this;return this.__stateList__.map(function(t){if(!r[t]){var e=RegExp("("+("\\{\\{\\?"+t+"\\}\\}")+")(.*?)(?="+("\\{\\{\\/"+t+"\\}\\}")+")"),n=e.test(o),i=o.match(e);n&&i&&(o=o.replace(i[2],""))}o=(o=o.replace("{{?"+t+"}}","")).replace("{{/"+t+"}}","")}),o}},{}],6:[function(t,e){var o=t("./genElement").setState,r=t("./tmplHandler"),a=t("./processEvent"),s=t("../utils").getId,l=t("../utils").testEvent,c=t("./componentParse"),u=t("./modelParse"),f=t("./nodesVisibility"),p=t("../utils").checkNodeAvailability,d=function(t,e,n){t.stubRender(this.__componentStub__[e],n)};e.exports=function(t){var e,n,i=this;if("string"==typeof this.base){if(this.__stateList__=this.__stateList__||[],this.__modelList__=this.__modelList__||[],this.__componentList__=this.__componentList__||[],this.__componentStub__=this.__componentStub__||{},n=r.call(this,function(t){~i.__stateList__.indexOf(t)||(i.__stateList__=i.__stateList__.concat(t))}),n=c.call(this,n),n=u.call(this,n),n=f.call(this,n),t)return n;(e=s(this.el))&&(e.innerHTML=n,this.__componentList__.map(function(t){var e=i[t];if(e){var n=p(e,t,d.bind(i));n&&d.call(i,e,t,n)}}),o.call(this),l(n)&&a.call(this,e),this.componentDidMount&&"function"==typeof this.componentDidMount&&this.componentDidMount())}}},{"../utils":13,"./componentParse":1,"./genElement":2,"./modelParse":4,"./nodesVisibility":5,"./processEvent":7,"./tmplHandler":10}],7:[function(t,e){var o=t("../utils").loopChilds,f=function(t,e,n){var i,o,r,a,s,l,c,u=e.attributes;t<u.length?(/^k-/.test(u[t].nodeName)&&(i=u[t].nodeName.replace(/^[^-]+-/,""),o=u[t].nodeValue.match(/[a-zA-Z]+(?![^(]*\))/)[0],r=(c=u[t].nodeValue.match(/\(([^{}]+)\)/))?c[1]:"","function"==typeof(a=this[o])&&(n.push(u[t].nodeName),s=[],(l=r.split(",").filter(function(t){return""!==t})).length&&l.map(function(t){s.push(t)}),e.addEventListener(i,a.bind.apply(a.bind(this),[e].concat(s)),!1))),f.call(this,++t,e,n)):n.map(function(t){e.removeAttribute(t)})};e.exports=function(t){var e=this,n=[],i=[];o(n,t),n.map(function(t){1===t.nodeType&&t.hasAttributes()&&f.call(e,0,t,i)}),n=[]}},{"../utils":13}],8:[function(t,e){e.exports=function(t){var e=t.match(/\.*\./g);if(e&&0<e.length)return t.split(".")}},{}],9:[function(t,e){function r(t){return"''"===t||'""'===t?"":t}e.exports=function(t){if(t.match(/([^?]*)\?([^:]*):([^;]*)|(\s*=\s*)[^;]*/g)){var e=t.split("?"),n=e[0],i=e[1].split(":")[0],o=e[1].split(":")[1];return this[n]?{value:r(i),state:n}:{value:r(o),state:n}}return!1}},{}],10:[function(t,e){var c=t("./strInterpreter"),u=t("./ternaryOps");e.exports=function(a){var s=this,l=this.base,t=l.match(/{{([^{}]+)}}/g);return t&&t.length&&t.map(function(t){var e=t.replace(/{{([^{}]+)}}/g,"$1"),n=c(e),i=u.call(s,e);if(n?(a(e),l=l.replace("{{"+e+"}}",s[n[0]][n[1]])):void 0!==s[e]?(a(e),l=l.replace("{{"+e+"}}",s[e])):i&&(a(i.state),l=l.replace("{{"+e+"}}",i.value)),e.match(/^\?/g)&&a(e.replace("?","")),e.match(/^model:/g)){var o=e.replace("model:","");~s.__modelList__.indexOf(o)||s.__modelList__.push(o)}if(e.match(/^component:/g)){var r=e.replace("component:","");~s.__componentList__.indexOf(r)||s.__componentList__.push(r)}}),l}},{"./strInterpreter":8,"./ternaryOps":9}],11:[function(t,e){"use strict";var n=t("./components/parseStr"),i=t("./components/genElement").setState,o=t("./components/genElement").genElement,r=t("./components/processEvent"),a=t("./utils").getId,s=t("./utils").testEvent,l=t("./utils").loopChilds,c=t("./utils").assert;function u(){}u.prototype.mount=function(t){var e,n=[];if("string"==typeof t)e=t.trim().replace(/\s+/g," ");else if("object"==typeof t&&t.nodeType){if(1===t.nodeType)e=""+t.outerHTML;else if(11===t.nodeType||3===t.nodeType){e=(new XMLSerializer).serializeToString(t)}else c(!1,"Unable to parse instance, unknown type.");l(n,t),n.map(function(t){t.remove()})}else c("string"==typeof t||"object"==typeof t,"Parameter is not a string or a html element.");return this.base=e,this},u.prototype.flush=function(t){var e=a(t||this.el);return e&&(e.innerHTML=""),this},u.prototype.link=function(t){return t||c(t,"No id is given as parameter."),this.el=t,this.componentWillMount&&"function"==typeof this.componentWillMount&&this.componentWillMount(),this.render(),this},u.prototype.render=function(t){return t?(!this.WILL_MOUNT&&this.componentWillMount&&"function"==typeof this.componentWillMount&&(this.WILL_MOUNT=!0,this.componentWillMount()),n.call(this,t)):(n.call(this),this)},u.prototype.cluster=function(){var t=[].slice.call(arguments);0<t.length&&t.map(function(t){"function"==typeof t&&t()})},u.prototype.stubRender=function(t,e){i.call(this),s(t)&&r.call(this,e),!this.DID_MOUNT&&this.componentDidMount&&"function"==typeof this.componentDidMount&&(this.DID_MOUNT=!0,this.componentDidMount())},u.prototype.callBatchPoolUpdate=function(){o.call(this,!0)},e.exports=u},{"./components/genElement":2,"./components/parseStr":6,"./components/processEvent":7,"./utils":13}],12:[function(t,e){"use strict";var A,C="http://www.w3.org/1999/xhtml",I="undefined"==typeof document?void 0:document,n=I?I.body||I.createElement("div"):{},l=n.hasAttributeNS?function(t,e,n){return t.hasAttributeNS(e,n)}:n.hasAttribute?function(t,e,n){return t.hasAttribute(n)}:function(t,e,n){return null!=t.getAttributeNode(e,n)};function U(t,e){var n=t.nodeName,i=e.nodeName;return n===i||!!(e.actualize&&n.charCodeAt(0)<91&&90<i.charCodeAt(0))&&n===i.toUpperCase()}function i(t,e,n){t[n]!==e[n]&&(t[n]=e[n],t[n]?t.setAttribute(n,""):t.removeAttribute(n,""))}var O={OPTION:function(t,e){i(t,e,"selected")},INPUT:function(t,e){i(t,e,"checked"),i(t,e,"disabled"),t.value!==e.value&&(t.value=e.value),l(e,null,"value")||t.removeAttribute("value")},TEXTAREA:function(t,e){var n=e.value;t.value!==n&&(t.value=n);var i=t.firstChild;if(i){var o=i.nodeValue;if(o==n||!n&&o==t.placeholder)return;i.nodeValue=n}},SELECT:function(t,e){if(!l(e,null,"multiple")){for(var n=0,i=e.firstChild;i;){var o=i.nodeName;if(o&&"OPTION"===o.toUpperCase()){if(l(i,null,"selected")){n;break}n++}i=i.nextSibling}t.selectedIndex=n}}};function P(){}function V(t){return t.id}var w,o=(w=function(t,e){var n,i,o,r,a,s=e.attributes;for(n=s.length-1;0<=n;--n)o=(i=s[n]).name,a=i.value,(r=i.namespaceURI)?t.getAttributeNS(r,o=i.localName||o)!==a&&t.setAttributeNS(r,o,a):t.getAttribute(o)!==a&&t.setAttribute(o,a);for(n=(s=t.attributes).length-1;0<=n;--n)!1!==(i=s[n]).specified&&(o=i.name,(r=i.namespaceURI)?l(e,r,o=i.localName||o)||t.removeAttributeNS(r,o):l(e,null,o)||t.removeAttribute(o))},function(m,v,t){if(t||(t={}),"string"==typeof v)if("#document"===m.nodeName||"HTML"===m.nodeName){var e=v;(v=I.createElement("html")).innerHTML=e}else n=v,!A&&I.createRange&&(A=I.createRange()).selectNode(I.body),A&&A.createContextualFragment?i=A.createContextualFragment(n):(i=I.createElement("body")).innerHTML=n,v=i.childNodes[0];var n,i,o,_=t.getNodeKey||V,g=t.onBeforeNodeAdded||P,r=t.onNodeAdded||P,b=t.onBeforeElUpdated||P,y=t.onElUpdated||P,a=t.onBeforeNodeDiscarded||P,s=t.onNodeDiscarded||P,N=t.onBeforeElChildrenUpdated||P,l=!0===t.childrenOnly,T={};function E(t){o?o.push(t):o=[t]}function x(t,e,n){!1!==a(t)&&(e&&e.removeChild(t),s(t),function t(e,n){if(1===e.nodeType)for(var i=e.firstChild;i;){var o=void 0;n&&(o=_(i))?E(o):(s(i),i.firstChild&&t(i,n)),i=i.nextSibling}}(t,n))}function L(t){r(t);for(var e=t.firstChild;e;){var n=e.nextSibling,i=_(e);if(i){var o=T[i];o&&U(e,o)&&(e.parentNode.replaceChild(o,e),S(o,e))}L(e),e=n}}function S(t,e,n){var i,o=_(e);if(o&&delete T[o],!v.isSameNode||!v.isSameNode(m)){if(!n){if(!1===b(t,e))return;if(w(t,e),y(t),!1===N(t,e))return}if("TEXTAREA"!==t.nodeName){var r,a,s,l,c=e.firstChild,u=t.firstChild;t:for(;c;){for(s=c.nextSibling,r=_(c);u;){if(a=u.nextSibling,c.isSameNode&&c.isSameNode(u)){c=s,u=a;continue t}i=_(u);var f=u.nodeType,p=void 0;if(f===c.nodeType&&(1===f?(r?r!==i&&((l=T[r])?u.nextSibling===l?p=!1:(t.insertBefore(l,u),a=u.nextSibling,i?E(i):x(u,t,!0),u=l):p=!1):i&&(p=!1),(p=!1!==p&&U(u,c))&&S(u,c)):3!==f&&8!=f||(p=!0,u.nodeValue!==c.nodeValue&&(u.nodeValue=c.nodeValue))),p){c=s,u=a;continue t}i?E(i):x(u,t,!0),u=a}if(r&&(l=T[r])&&U(l,c))t.appendChild(l),S(l,c);else{var d=g(c);!1!==d&&(d&&(c=d),c.actualize&&(c=c.actualize(t.ownerDocument||I)),t.appendChild(c),L(c))}c=s,u=a}for(;u;)a=u.nextSibling,(i=_(u))?E(i):x(u,t,!0),u=a}var h=O[t.nodeName];h&&h(t,e)}}!function t(e){if(1===e.nodeType)for(var n=e.firstChild;n;){var i=_(n);i&&(T[i]=n),t(n),n=n.nextSibling}}(m);var c,u,f=m,p=f.nodeType,d=v.nodeType;if(!l)if(1===p)1===d?U(m,v)||(s(m),f=function(t,e){for(var n=t.firstChild;n;){var i=n.nextSibling;e.appendChild(n),n=i}return e}(m,(c=v.nodeName,(u=v.namespaceURI)&&u!==C?I.createElementNS(u,c):I.createElement(c)))):f=v;else if(3===p||8===p){if(d===p)return f.nodeValue!==v.nodeValue&&(f.nodeValue=v.nodeValue),f;f=v}if(f===v)s(m);else if(S(f,v,l),o)for(var h=0,M=o.length;h<M;h++){var D=T[o[h]];D&&x(D,D.parentNode,!1)}return!l&&f!==m&&m.parentNode&&(f.actualize&&(f=f.actualize(m.ownerDocument||I)),m.parentNode.replaceChild(f,m)),f});e.exports=o},{}],13:[function(t,e,n){var s=function(t){return document.getElementById(t)};n.getId=s;var i=function(t,e){for(var n=e.firstChild;null!==n;n=n.nextSibling)t.push(n),n.hasChildNodes()&&i(t,n)};n.loopChilds=i,n.testEvent=function(t){return/ k-/.test(t)},n.checkNodeAvailability=function(t,e,n,i){var o=s(t.el),r=!1;if(o)return o;var a=setInterval(function(){(o=s(t.el))&&(clearInterval(a),r=!0,n(t,e,o))},0);setTimeout(function(){clearInterval(a),!r&&i&&"function"==typeof i&&i()},250)},n.assert=function(t,e){if(!t)throw Error("(keet) "+e)},n.html=function(){var t=[].shift.call(arguments),i=[].slice.call(arguments),e=t.raw.reduce(function(t,e,n){return t+i[n-1]+e});return e=(e=e.split(/\n+/)).map(function(t){return t.trim()}).join("")},n.createModel=function(){var e=[],n=[];Object.defineProperty(this,"list",{enumerable:!1,configurable:!0,get:function(){return e},set:function(t){e=t,function(){for(var t=n.length;t--;)n[t](e)}()}}),this.subscribe=function(t){n.push(t)},this.add=function(t){this.list=this.list.concat(t)},this.update=function(e,n){this.list=this.list.map(function(t){return t[e]!==n[e]?t:Object.assign(t,n)})},this.destroy=function(e,n){this.list=this.list.filter(function(t){return t[e]!==n})}}},{}]},{},[11])(11)});
/**
 * Keetjs v4.0.0 Alpha release: https://github.com/keetjs/keet.js
 * Minimalist view layer for the web
 *
 * <<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Keetjs >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
 *
 * Copyright 2018, Shahrul Nizam Selamat
 * Released under the MIT License.
 */
