!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Keet=t()}}(function(){return function o(s,a,l){function c(e,t){if(!a[e]){if(!s[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(u)return u(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var r=a[e]={exports:{}};s[e][0].call(r.exports,function(t){return c(s[e][1][t]||t)},r,r.exports,o,s,a,l)}return a[e].exports}for(var u="function"==typeof require&&require,t=0;t<l.length;t++)c(l[t]);return c}({1:[function(t,e,n){e.exports=function(t){return Array.isArray(t)?t.map(function(t){return t}):function(t){var e={};if("object"!=typeof t)return e.copy=t,e.copy;for(var n in t)e[n]=t[n];return e}(t)}},{}],2:[function(t,e,n){var l=t("./copy"),c=t("./tag"),u=t("./tmplHandler"),p=t("./tmplStylesHandler"),d=t("./tmplClassHandler"),f=t("./tmplAttrHandler"),h=t("./processEvent"),s=t("./utils").selector,a=t("./strInterpreter"),m=t("./nodesVisibility"),v=t("hash-sum"),y=t("set-dom");y.key="keet-id";var b=function(){var n,i,r=this,o=[].slice.call(arguments);"object"==typeof this.base?Object.keys(this.base).map(function(t){var e=r.base[t]["keet-id"];(n=s(e))||"string"!=typeof r.base[t]||(n=document.getElementById(r.el)),i=N.apply(r,[r.base[t]].concat(o)),r.base.hasOwnProperty("template")&&(i.id=r.el),y(n,i)}):(n=document.getElementById(r.el))&&((i=N.apply(r,[r.base].concat(o))).id=r.el,y(n,i)),g.status="ready"},g={ttl:null,status:"ready"},_=function(t,e){var n=this;if(t<this.__stateList__.length){var i=this.__stateList__[t],r=this[i];if(void 0===r&&(r=a(i)),r&&Array.isArray(r)){var o=this[r[0]][r[1]];Object.defineProperty(this[r[0]],r[1],{enumerable:!1,configurable:!0,get:function(){return o},set:function(t){o=t,b.apply(n,e)}})}else Object.defineProperty(this,i,{enumerable:!1,configurable:!0,get:function(){return r},set:function(t){r=t,b.apply(n,e)}});t++,_.apply(this,[t,e])}},E=function(t){_.apply(this,[0,t])},x=function(t){this.__stateList__=this.__stateList__.concat(t)},N=function(){var t=[].shift.call(arguments),e=[].slice.call(arguments),n=document.createElement("div"),i=l(t);delete i.template,delete i.tag,delete i.style,delete i.class,this.__stateList__=[];var r=t.template?u.call(this,t.template,x.bind(this)):"string"==typeof t?u.call(this,t,x.bind(this)):null,o=p.call(this,t.style,x.bind(this)),s=d.call(this,t,x.bind(this));s&&(i.class=s),e&&e.length&&f.apply(this,[i].concat(e));var a=t.tag?c(t.tag,r||"",i,o):r;return a=m.call(this,a),n.innerHTML=a,n.childNodes.forEach(function(t){1===t.nodeType&&t.setAttribute("data-checksum",v(t.outerHTML))}),"input"===t.tag&&(i.checked?n.childNodes[0].setAttribute("checked",""):n.childNodes[0].removeAttribute("checked")),E.call(this,e),h.call(this,n),"string"==typeof t?n:t.tag?n.childNodes[0]:n};n.genElement=N,n.setState=E,n.updateStateList=x},{"./copy":1,"./nodesVisibility":4,"./processEvent":6,"./strInterpreter":7,"./tag":8,"./tmplAttrHandler":10,"./tmplClassHandler":11,"./tmplHandler":12,"./tmplStylesHandler":13,"./utils":14,"hash-sum":16,"set-dom":17}],3:[function(t,e,n){var c=t("./processEvent"),u=t("./ternaryOps"),p=t("./utils").testEvent,d="";e.exports=function(t){var e,n,i=this.args,r=this.base.template.match(/{{([^{}]+)}}/g);d=this.base.template;for(var o=0,s=r.length;o<s;o++){n=r[o].replace(/{{([^{}]+)}}/g,"$1");var a=u.call(t,n);if(d=a?(i&&i.indexOf(a.state),d.replace("{{"+n+"}}",a.value)):d.replace("{{"+n+"}}",t[n]),i&&~i.indexOf(n)&&!t[n]){var l=new RegExp(" "+n+'="'+t[n]+'"',"g");d=d.replace(l,"")}}return(e=document.createElement("div")).innerHTML=d,p(d)&&c.call(this,e),e.childNodes[0].setAttribute("keet-id",t["keet-id"]),e.childNodes[0]}},{"./processEvent":6,"./ternaryOps":9,"./utils":14}],4:[function(t,e,n){e.exports=function(r){var o=this;return this.__stateList__.map(function(t){if(!o[t]){var e=new RegExp("("+("\\{\\{\\?"+t+"\\}\\}")+")(.*?)(?="+("\\{\\{\\/"+t+"\\}\\}")+")"),n=e.test(r),i=r.match(e);n&&i&&(r=r.replace(i[2],""))}r=(r=r.replace("{{?"+t+"}}","")).replace("{{/"+t+"}}","")}),r}},{}],5:[function(t,e,n){var c=t("./genElement").genElement,u=t("./genElement").setState,p=t("./tmplHandler"),d=t("./processEvent"),f=t("./utils").genId,i=t("./utils").testEvent,r=t("./genTemplate"),h=t("./nodesVisibility"),m=t("hash-sum");e.exports=function(){var s=this,a=[],l=[].slice.call(arguments);if(Array.isArray(this.base.model))this.base.template=this.base.template.trim().replace(/\s+/g," "),this.base.model=this.base.model.map(function(t){return t["keet-id"]=f(),t}),this.base.model.map(function(t){a.push(r.call(s,t))});else if("object"==typeof this.base)Object.keys(this.base).map(function(t){var e=s.base[t];if(e&&"object"==typeof e){var n=f();e["keet-id"]=n,s.base[t]["keet-id"]=n;var i=c.apply(s,[e].concat(l));a.push(i)}else{s.__stateList__=[];var r=p.call(s,e,function(t){s.__stateList__=s.__stateList__.concat(t)});r=h.call(s,r);var o=document.createElement("div");o.innerHTML=r,u.call(s,l),d.call(s,o),o.childNodes.forEach(function(t){1===t.nodeType&&t.setAttribute("data-checksum",m(t.outerHTML)),a.push(t)})}});else if("string"==typeof this.base){this.__stateList__=[];var t=p.call(this,this.base,function(t){s.__stateList__=s.__stateList__.concat(t)});t=h.call(this,t);var e=document.createElement("div");e.innerHTML=t,u.call(this,l),i(t)&&d.call(this,e),e.childNodes.forEach(function(t){1===t.nodeType&&t.setAttribute("data-checksum",m(t.outerHTML)),a.push(t)})}return a}},{"./genElement":2,"./genTemplate":3,"./nodesVisibility":4,"./processEvent":6,"./tmplHandler":12,"./utils":14,"hash-sum":16}],6:[function(t,e,n){var r=t("./utils").loopChilds,c=function(t,e,n){var i,r,o,s,a,l=e.attributes;t<l.length?(/^k-/.test(l[t].nodeName)&&(i=l[t].nodeName.split("-")[1],"function"==typeof(o=this[(r=l[t].nodeValue.split("("))[0]])&&(n.push(l[t].nodeName),s=[],(a=r[1].slice(0,-1).split(",").filter(function(t){return""!==t})).length&&a.map(function(t){s.push(t)}),e.addEventListener(i,o.bind.apply(o.bind(this),[e].concat(s)),!1))),t++,c.apply(this,[t,e,n])):n.map(function(t){e.removeAttribute(t)})};e.exports=function(t){var e=this,n=[],i=[];r(n,t),n.map(function(t){1===t.nodeType&&t.hasAttributes()&&c.apply(e,[0,t,i])}),n=[]}},{"./utils":14}],7:[function(t,e,n){e.exports=function(t){var e=t.match(/\.*\./g);if(e&&0<e.length)return t.split(".")}},{}],8:[function(t,e,n){e.exports=function(){return function(){var t,e,n=[].slice.call(arguments),i=["<",n[0],">",n[1],"</",n[0],">"];if(2<n.length&&"object"==typeof n[2])for(t in n[2])"boolean"==typeof n[2][t]&&n[2][t]?i.splice(2,0," ",t):"class"===t&&Array.isArray(n[2][t])?i.splice(2,0," ",t,'="',n[2][t].join(" ").trim(),'"'):i.splice(2,0," ",t,'="',n[2][t],'"');if(3<n.length&&"object"==typeof n[3]){for(t in e=[i.indexOf(">"),0,' style="'],n[3])e.push(t),e.push(":"),e.push(n[3][t]),e.push(";");e.push('"'),i.splice.apply(i,e)}return i}.apply(null,arguments).join("")}},{}],9:[function(t,e,n){function o(t){return"''"===t||'""'===t?"":t}e.exports=function(t){if(t.match(/([^?]*)\?([^:]*):([^;]*)|(\s*=\s*)[^;]*/g)){var e=t.split("?"),n=e[0],i=e[1].split(":")[0],r=e[1].split(":")[1];return this[n]?{value:o(i),state:n}:{value:o(r),state:n}}return!1}},{}],10:[function(t,e,n){var s=t("./genElement");e.exports=function(){var r=this,o=[].shift.call(arguments);Object.keys(o).map(function(n){var t=o[n].match(/{{([^{}]+)}}/g);if(t&&t.length){var i="";t.map(function(t){var e=t.replace(/{{([^{}]+)}}/g,"$1");void 0!==r[e]&&(s.updateStateList.call(r,e),!1===r[e]?delete o[n]:(i+=r[e],o[n]=i))})}})}},{"./genElement":2}],11:[function(t,e,n){e.exports=function(t,n){var i=this;if(t.class){var e=t.class.match(/{{([^{}]+)}}/g),r="";return e&&e.length&&e.map(function(t){var e=t.replace(/{{([^{}]+)}}/g,"$1");void 0!==i[e]&&(n(e),i[e].cstore.map(function(t){r+=t+" "}))}),r.length?r.trim():t.class}return!1}},{}],12:[function(t,e,n){var a=t("./strInterpreter"),l=t("./ternaryOps");e.exports=function(r,o){var s=this,t=r.match(/{{([^{}]+)}}/g);return t&&t.length&&t.map(function(t){var e=t.replace(/{{([^{}]+)}}/g,"$1"),n=a(e),i=l.call(s,e);n?(o(e),r=r.replace("{{"+e+"}}",s[n[0]][n[1]])):void 0!==s[e]?(o(e),r=r.replace("{{"+e+"}}",s[e])):i&&(o(i.state),r=r.replace("{{"+e+"}}",i.value)),e.match(/^\?/g)&&o(e.replace("?",""))}),r}},{"./strInterpreter":7,"./ternaryOps":9}],13:[function(t,e,n){var s=t("./copy");e.exports=function(t,i){var r=this,o=s(t);return t&&Object.keys(o).map(function(n){var t=o[n].match(/{{([^{}]+)}}/g);t&&t.length&&t.map(function(t){var e=t.replace(/{{([^{}]+)}}/g,"$1");void 0!==r[e]&&(i(e),o[n]=o[n].replace(/{{([^{}]+)}}/,r[e]))})}),o}},{"./copy":1}],14:[function(t,e,n){var l=function(t){return document.getElementById(t)};n.getId=l,n.genId=function(){return Math.round(1*Math.random()*1e12).toString(32)},n.selector=function(t){return document.querySelector('[keet-id="'+t+'"]')};var i=function(t,e){for(var n=e.firstChild;null!==n;n=n.nextSibling)t.push(n),n.hasChildNodes()&&i(t,n)};n.loopChilds=i,n.checkNodeAvailabity=function(t,e,n){var i,r=!1,o=this.el,s=this,a=setInterval(function(){(i=l(o))&&(clearInterval(a),r=!0,n.call(s,i,t,e))},0);setTimeout(function(){if(!r)throw clearInterval(a),new Error("Unable to find html entity with id "+o+".")},500)},n.available=function(t,e,n){t.appendChild(n.call(this,e))},n.fn=function(t){return"function"==typeof t},n.testEvent=function(t){return/ k-/.test(t)}},{}],15:[function(t,e,n){"use strict";var i=t("./components/utils").getId,r=t("./components/utils").genId,c=t("./components/utils").selector,u=t("./components/utils").fn,o=t("./components/utils").checkNodeAvailabity,s=t("./components/utils").available,a=t("./components/parseStr"),p=t("./components/genTemplate"),d=t("set-dom");d.key="keet-id";var l=function(t,e,n){var i,r=this;if(t<n.length)e.childNodes[t]||e.appendChild(n[t]),t++,l.apply(this,[t,e,n]);else{"object"==typeof this.base&&(this.baseProxy=(i=this.base,new Proxy(i,{set:function(t,e,n){return t[e]=n,r.base[e]=t[e],!0},deleteProperty:function(t,e){var n=t[e]["keet-id"],i=c(n);return i&&i.remove(),delete r.base[e],!0}}))),this.componentDidMount&&"function"==typeof this.componentDidMount&&this.componentDidMount()}};function f(){Object.defineProperty(this,"__stateList__",{enumerable:!1,writable:!0})}f.prototype.mount=function(e){return"object"==typeof e?Object.keys(e).map(function(t){"string"==typeof e[t]?e[t]=e[t].trim().replace(/\s+/g," "):"object"==typeof e[t]&&"string"==typeof e[t].template&&(e[t].template=e[t].template.trim().replace(/\s+/g," "))}):"string"==typeof e&&(e=e.trim().replace(/\s+/g," ")),this.base=e,this},f.prototype.flush=function(t){var e=i(this.el);return e&&(e.innerHTML=""),this},f.prototype.link=function(t){return this.el=t,this.componentWillMount&&"function"==typeof this.componentWillMount&&this.componentWillMount(),this.render(),this},f.prototype.render=function(){var t=i(this.el),e=a.apply(this,this.args);return t&&l.apply(this,[0,t,e]),this},f.prototype.cluster=function(){var t=[].slice.call(arguments);0<t.length&&t.map(function(t){"function"==typeof t&&t()})},f.prototype.add=function(t,e){var n=i(this.el);t["keet-id"]=r(),this.base.model=this.base.model.concat(t),e&&u(e)&&e.call(this),n&&n.appendChild(p.call(this,t))||o.call(this,t,p,s)},f.prototype.destroy=function(i,r,o){var s=this;this.base.model=this.base.model.filter(function(t,e){if(i!==t[r])return t;var n=c(t["keet-id"]);n&&(o&&u(o)&&o.call(s),n.remove())})},f.prototype.update=function(r,o,s,a){var l=this;this.base.model=this.base.model.map(function(t,e,n){if(r===t[o]){s&&"object"==typeof s&&Object.assign(t,s);var i=c(t["keet-id"]);i&&(a&&u(a)&&a.call(l),d(i,p.call(l,t)))}return t})},e.exports=f},{"./components/genTemplate":3,"./components/parseStr":5,"./components/utils":14,"set-dom":17}],16:[function(t,e,n){"use strict";function c(t,e){var n,i;if(0===e.length)return t;for(n=0,i=e.length;n<i;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t<0?-2*t:t}function u(t,e,n,i){var r,o,s,a,l=c(c(c(t,n),(r=e,Object.prototype.toString.call(r))),typeof e);return null===e?c(l,"null"):void 0===e?c(l,"undefined"):"object"==typeof e?-1!==i.indexOf(e)?c(l,"[Circular]"+n):(i.push(e),o=l,s=e,a=i,Object.keys(s).sort().reduce(function(t,e){return u(t,s[e],e,a)},o)):c(l,e.toString())}e.exports=function(t){return function(t,e){for(;t.length<e;)t="0"+t;return t}(u(0,t,"",[]).toString(16),8)}},{}],17:[function(t,e,n){"use strict";c.KEY="data-key",c.IGNORE="data-ignore",c.CHECKSUM="data-checksum";var i=t("./parse-html"),r="_set-dom-",o=r+"mounted",s=1,a=9,l=11;function c(t,e){!function(t,e){if(!t)throw new Error("set-dom: "+e)}(t&&t.nodeType,"You must provide a valid node to update."),t.nodeType===a&&(t=t.documentElement),e.nodeType===l?u(t,e):p(t,"string"==typeof e?i(e,t.nodeName):e),t[o]||(t[o]=!0,m(t))}function p(t,e){if(t.nodeType===e.nodeType)if(t.nodeType===s){if(r=e,h(i=t)&&h(r)||f(i)===f(r)||i.isEqualNode(r))return;if(u(t,e),t.nodeName===e.nodeName)!function(t,e){var n,i,r,o,s;for(n=t.length;n--;)i=t[n],o=i.namespaceURI,s=i.localName,(r=e.getNamedItemNS(o,s))||t.removeNamedItemNS(o,s);for(n=e.length;n--;)i=e[n],o=i.namespaceURI,s=i.localName,(r=t.getNamedItemNS(o,s))?r.value!==i.value&&(r.value=i.value):(e.removeNamedItemNS(o,s),t.setNamedItemNS(i))}(t.attributes,e.attributes);else{for(var n=e.cloneNode();t.firstChild;)n.appendChild(t.firstChild);t.parentNode.replaceChild(n,t)}}else t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue);else t.parentNode.replaceChild(e,v(t)),m(e);var i,r}function u(t,e){for(var n,i,r,o,s,a,l=t.firstChild,c=e.firstChild,u=0;l;)u++,i=d(n=l),l=l.nextSibling,i&&(a||(a={}),a[i]=n);for(l=t.firstChild;c;)u--,c=(r=c).nextSibling,a&&(o=d(r))&&(s=a[o])?(delete a[o],s!==l?t.insertBefore(s,l):l=l.nextSibling,p(s,r)):l?(l=(n=l).nextSibling,d(n)?(t.insertBefore(r,n),m(r)):p(n,r)):(t.appendChild(r),m(r));for(i in a)u--,t.removeChild(v(a[i]));for(;0<=--u;)t.removeChild(v(t.lastChild))}function d(t){if(t.nodeType===s){var e=t.getAttribute(c.KEY)||t.id;return e?r+e:void 0}}function f(t){return t.getAttribute(c.CHECKSUM)||NaN}function h(t){return null!=t.getAttribute(c.IGNORE)}function m(t){return y(t,"mount")}function v(t){return y(t,"dismount")}function y(t,e){if(d(t)){var n=document.createEvent("Event"),i={value:t};n.initEvent(e,!1,!1),Object.defineProperty(n,"target",i),Object.defineProperty(n,"srcElement",i),t.dispatchEvent(n)}for(var r=t.firstChild;r;)r=y(r,e).nextSibling;return t}e.exports=c},{"./parse-html":18}],18:[function(t,e,n){"use strict";var l=window.DOMParser&&new window.DOMParser,c="HTML",i=!1,u=!1,r="text/html",p="application/xhtml+xml",o='<wbr class="A"/>';try{var s=l.parseFromString(o,r).body.firstChild,a=document.createElement("div");if(a.appendChild(s),"A"!==a.firstChild.classList[0])throw new Error;i=!0}catch(t){}var d=document.implementation.createHTMLDocument(""),f=d.documentElement,h=d.body;try{f.innerHTML+="",u=!0}catch(t){l.parseFromString(o,p);var m=/(<body[^>]*>)([\s\S]*)<\/body>/}function v(t,e){if(e===c){if(u)return f.innerHTML=t,f;var n=t.match(m);if(n){var i=n[2],r=n.index+n[1].length,o=r+i.length;t=t.slice(0,r)+t.slice(o),h.innerHTML=i}for(var s=l.parseFromString(t,p),a=s.body;h.firstChild;)a.appendChild(h.firstChild);return s.documentElement}return h.innerHTML=t,h.firstChild}e.exports=i?function(t,e){var n=l.parseFromString(t,r);return n.body?e===c?n.documentElement:n.body.firstChild:v(t,e)}:v},{}]},{},[15])(15)});
/**
 * Keetjs v3.5.2 Alpha release: https://github.com/keetjs/keet.js
 * Minimalist view layer for the web
 *
 * <<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Keetjs >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
 *
 * Copyright 2018, Shahrul Nizam Selamat
 * Released under the MIT License.
 */
