!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Keet=e()}}(function(){return function r(a,l,s){function c(t,e){if(!l[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);var i=Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var o=l[t]={exports:{}};a[t][0].call(o.exports,function(e){return c(a[t][1][e]||e)},o,o.exports,r,a,l,s)}return l[t].exports}for(var u="function"==typeof require&&require,e=0;e<s.length;e++)c(s[e]);return c}({1:[function(e,t){t.exports=function(i){var o=this;return this.__componentList__.map(function(e){if(o[e]){o[e].IS_STUB=!0;var t=RegExp("(\\{\\{component:"+e+"\\}\\})","g"),n=o[e].render("asString");i=i.replace(t,o.__componentStub__[e]=n)}}),i}},{}],2:[function(e,t,n){var i=e("./tmplHandler"),o=e("./processEvent"),r=e("../utils").getId,a=e("../utils").testEvent,l=e("../utils").loopChilds,s=e("./strInterpreter"),c=e("./componentParse"),u=e("./modelParse"),f=e("./nodesVisibility"),d=e("morphdom"),p=function(){var e=r(this.el),t=b.call(this),n=[];this.IS_STUB?d(e,t.childNodes[0]):(t.id=this.el,d(e,t),l(n,t),n.map(function(e){e.remove()})),this.componentDidUpdate&&"function"==typeof this.componentDidUpdate&&this.componentDidUpdate(),h.status="ready"},h={ttl:0,status:"ready"},m=function(){var e=this;"pooling"!==h.status&&(h.status="pooling",h.ttl?(clearTimeout(h.ttl),h.ttl=setTimeout(function(){p.call(e)},0)):p.call(this),h.ttl=setTimeout(function(){h.ttl=0},100))},v=function(e){var t=this;if(e<this.__stateList__.length){var n=this.__stateList__[e],i=this[n];if(void 0===i&&(i=s(n)),i&&Array.isArray(i)){var o=this[i[0]][i[1]];Object.defineProperty(this[i[0]],i[1],{enumerable:!1,configurable:!0,get:function(){return o},set:function(e){o=e,m.call(t)}})}else Object.defineProperty(this,n,{enumerable:!1,configurable:!0,get:function(){return i},set:function(e){i=e,m.call(t)}});v.call(this,++e)}},_=function(){v.call(this,0)},g=function(e){~this.__stateList__.indexOf(e)||(this.__stateList__=this.__stateList__.concat(e))},b=function(e){var t=document.createElement("div"),n=i.call(this,g.bind(this));return n=c.call(this,n),n=u.call(this,n),n=f.call(this,n),t.innerHTML=n,_.call(this),a(n)&&o.call(this,t),e&&m.call(this),t};n.genElement=b,n.setState=_,n.updateStateList=g},{"../utils":13,"./componentParse":1,"./modelParse":4,"./nodesVisibility":5,"./processEvent":7,"./strInterpreter":8,"./tmplHandler":10,morphdom:12}],3:[function(e,t){var l=e("./ternaryOps"),s="";t.exports=function(e,t){var n,i,o=e.match(/{{([^{}]+)}}/g);s=e;for(var r=0,a=o.length;r<a;r++)n=o[r].replace(/{{([^{}]+)}}/g,"$1"),i=l.call(t,n),s=s.replace("{{"+n+"}}",i?i.value:t[n]);return s}},{"./ternaryOps":9}],4:[function(e,t){var l=e("./genModelTemplate");t.exports=function(r){var a=this;return this.__modelList__.map(function(e){if(a[e]){var t=RegExp("(\\{\\{model:"+e+"\\}\\})(.*?)(\\{\\{\\/model:"+e+"\\}\\})"),n=r.match(t);if(n){var i=a.base.match(t),o="";a[e].list.map(function(e){o+=l.call(a,i[2],e)}),r=r.replace(n[2],o)}}r=(r=r.replace("{{model:"+e+"}}","")).replace("{{/model:"+e+"}}","")}),r}},{"./genModelTemplate":3}],5:[function(e,t){t.exports=function(o){var r=this;return this.__stateList__.map(function(e){if(!r[e]){var t=RegExp("("+("\\{\\{\\?"+e+"\\}\\}")+")(.*?)(?="+("\\{\\{\\/"+e+"\\}\\}")+")"),n=t.test(o),i=o.match(t);n&&i&&(o=o.replace(i[2],""))}o=(o=o.replace("{{?"+e+"}}","")).replace("{{/"+e+"}}","")}),o}},{}],6:[function(e,t){var o=e("./genElement").setState,r=e("./tmplHandler"),a=e("./processEvent"),l=e("../utils").getId,s=e("../utils").testEvent,c=e("./componentParse"),u=e("./modelParse"),f=e("./nodesVisibility"),d=e("../utils").checkNodeAvailability,p=function(e,t,n){e.stubRender(this.__componentStub__[t],n)};t.exports=function(e){var t,n,i=this;if("string"==typeof this.base){if(this.__stateList__=this.__stateList__||[],this.__modelList__=this.__modelList__||[],this.__componentList__=this.__componentList__||[],this.__componentStub__=this.__componentStub__||{},n=r.call(this,function(e){~i.__stateList__.indexOf(e)||(i.__stateList__=i.__stateList__.concat(e))}),n=c.call(this,n),n=u.call(this,n),n=f.call(this,n),e)return n;(t=l(this.el))&&(t.innerHTML=n,this.__componentList__.map(function(e){var t=i[e];if(t){var n=d(t,e,p.bind(i));n&&p.call(i,t,e,n)}}),o.call(this),s(n)&&a.call(this,t))}}},{"../utils":13,"./componentParse":1,"./genElement":2,"./modelParse":4,"./nodesVisibility":5,"./processEvent":7,"./tmplHandler":10}],7:[function(e,t){var o=e("../utils").loopChilds,f=function(e,t,n){var i,o,r,a,l,s,c,u=t.attributes;e<u.length?(/^k-/.test(u[e].nodeName)&&(i=u[e].nodeName.replace(/^[^-]+-/,""),o=u[e].nodeValue.match(/[a-zA-Z]+(?![^(]*\))/)[0],r=(c=u[e].nodeValue.match(/\(([^{}]+)\)/))?c[1]:"","function"==typeof(a=this[o])&&(n.push(u[e].nodeName),l=[],(s=r.split(",").filter(function(e){return""!==e})).length&&s.map(function(e){l.push(e)}),t.addEventListener(i,a.bind.apply(a.bind(this),[t].concat(l)),!1))),f.call(this,++e,t,n)):n.map(function(e){t.removeAttribute(e)})};t.exports=function(e){var t=this,n=[],i=[];o(n,e),n.map(function(e){1===e.nodeType&&e.hasAttributes()&&f.call(t,0,e,i)}),n=[]}},{"../utils":13}],8:[function(e,t){t.exports=function(e){var t=e.match(/\.*\./g);if(t&&0<t.length)return e.split(".")}},{}],9:[function(e,t){function r(e){return"''"===e||'""'===e?"":e}t.exports=function(e){if(e.match(/([^?]*)\?([^:]*):([^;]*)|(\s*=\s*)[^;]*/g)){var t=e.split("?"),n=t[0],i=t[1].split(":")[0],o=t[1].split(":")[1];return this[n]?{value:r(i),state:n}:{value:r(o),state:n}}return!1}},{}],10:[function(e,t){var c=e("./strInterpreter"),u=e("./ternaryOps");t.exports=function(a){var l=this,s=this.base,e=s.match(/{{([^{}]+)}}/g);return e&&e.length&&e.map(function(e){var t=e.replace(/{{([^{}]+)}}/g,"$1"),n=c(t),i=u.call(l,t);if(n?(a(t),s=s.replace("{{"+t+"}}",l[n[0]][n[1]])):void 0!==l[t]?(a(t),s=s.replace("{{"+t+"}}",l[t])):i&&(a(i.state),s=s.replace("{{"+t+"}}",i.value)),t.match(/^\?/g)&&a(t.replace("?","")),t.match(/^model:/g)){var o=t.replace("model:","");~l.__modelList__.indexOf(o)||l.__modelList__.push(o)}if(t.match(/^component:/g)){var r=t.replace("component:","");~l.__componentList__.indexOf(r)||l.__componentList__.push(r)}}),s}},{"./strInterpreter":8,"./ternaryOps":9}],11:[function(e,t){"use strict";var n=e("./components/parseStr"),i=e("./components/genElement").setState,o=e("./components/genElement").genElement,r=e("./components/processEvent"),a=e("./utils").getId,l=e("./utils").testEvent,s=e("./utils").loopChilds,c=e("./utils").assert;function u(){}u.prototype.mount=function(e){var t,n=[];if("string"==typeof e)t=e.trim().replace(/\s+/g," ");else if("object"==typeof e&&e.nodeType){if(1===e.nodeType)t=""+e.outerHTML;else if(11===e.nodeType||3===e.nodeType){t=(new XMLSerializer).serializeToString(e)}else c(!1,"Unable to parse instance, unknown type.");s(n,e),n.map(function(e){e.remove()})}else c("string"==typeof e||"object"==typeof e,"Parameter is not a string or a html element.");return this.base=t,this},u.prototype.flush=function(e){var t=a(e||this.el);return t&&(t.innerHTML=""),this},u.prototype.link=function(e){return e||c(e,"No id is given as parameter."),this.el=e,this.componentWillMount&&"function"==typeof this.componentWillMount&&this.componentWillMount(),this.render(),this},u.prototype.render=function(e){return e?n.call(this,e):(n.call(this),this.componentDidMount&&"function"==typeof this.componentDidMount&&this.componentDidMount(),this)},u.prototype.cluster=function(){var e=[].slice.call(arguments);0<e.length&&e.map(function(e){"function"==typeof e&&e()})},u.prototype.stubRender=function(e,t){i.call(this),l(e)&&r.call(this,t)},u.prototype.callBatchPoolUpdate=function(){o.call(this,!0)},t.exports=u},{"./components/genElement":2,"./components/parseStr":6,"./components/processEvent":7,"./utils":13}],12:[function(e,t){"use strict";var I,O="http://www.w3.org/1999/xhtml",M="undefined"==typeof document?void 0:document,n=M?M.body||M.createElement("div"):{},s=n.hasAttributeNS?function(e,t,n){return e.hasAttributeNS(t,n)}:n.hasAttribute?function(e,t,n){return e.hasAttribute(n)}:function(e,t,n){return null!=e.getAttributeNode(t,n)};function U(e,t){var n=e.nodeName,i=t.nodeName;return n===i||!!(t.actualize&&n.charCodeAt(0)<91&&90<i.charCodeAt(0))&&n===i.toUpperCase()}function i(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n,""))}var V={OPTION:function(e,t){i(e,t,"selected")},INPUT:function(e,t){i(e,t,"checked"),i(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),s(t,null,"value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var i=e.firstChild;if(i){var o=i.nodeValue;if(o==n||!n&&o==e.placeholder)return;i.nodeValue=n}},SELECT:function(e,t){if(!s(t,null,"multiple")){for(var n=0,i=t.firstChild;i;){var o=i.nodeName;if(o&&"OPTION"===o.toUpperCase()){if(s(i,null,"selected")){n;break}n++}i=i.nextSibling}e.selectedIndex=n}}};function w(){}function P(e){return e.id}var D,o=(D=function(e,t){var n,i,o,r,a,l=t.attributes;for(n=l.length-1;0<=n;--n)o=(i=l[n]).name,a=i.value,(r=i.namespaceURI)?e.getAttributeNS(r,o=i.localName||o)!==a&&e.setAttributeNS(r,o,a):e.getAttribute(o)!==a&&e.setAttribute(o,a);for(n=(l=e.attributes).length-1;0<=n;--n)!1!==(i=l[n]).specified&&(o=i.name,(r=i.namespaceURI)?s(t,r,o=i.localName||o)||e.removeAttributeNS(r,o):s(t,null,o)||e.removeAttribute(o))},function(m,v,e){if(e||(e={}),"string"==typeof v)if("#document"===m.nodeName||"HTML"===m.nodeName){var t=v;(v=M.createElement("html")).innerHTML=t}else n=v,!I&&M.createRange&&(I=M.createRange()).selectNode(M.body),I&&I.createContextualFragment?i=I.createContextualFragment(n):(i=M.createElement("body")).innerHTML=n,v=i.childNodes[0];var n,i,o,_=e.getNodeKey||P,g=e.onBeforeNodeAdded||w,r=e.onNodeAdded||w,b=e.onBeforeElUpdated||w,y=e.onElUpdated||w,a=e.onBeforeNodeDiscarded||w,l=e.onNodeDiscarded||w,N=e.onBeforeElChildrenUpdated||w,s=!0===e.childrenOnly,E={};function x(e){o?o.push(e):o=[e]}function S(e,t,n){!1!==a(e)&&(t&&t.removeChild(e),l(e),function e(t,n){if(1===t.nodeType)for(var i=t.firstChild;i;){var o=void 0;n&&(o=_(i))?x(o):(l(i),i.firstChild&&e(i,n)),i=i.nextSibling}}(e,n))}function T(e){r(e);for(var t=e.firstChild;t;){var n=t.nextSibling,i=_(t);if(i){var o=E[i];o&&U(t,o)&&(t.parentNode.replaceChild(o,t),L(o,t))}T(t),t=n}}function L(e,t,n){var i,o=_(t);if(o&&delete E[o],!v.isSameNode||!v.isSameNode(m)){if(!n){if(!1===b(e,t))return;if(D(e,t),y(e),!1===N(e,t))return}if("TEXTAREA"!==e.nodeName){var r,a,l,s,c=t.firstChild,u=e.firstChild;e:for(;c;){for(l=c.nextSibling,r=_(c);u;){if(a=u.nextSibling,c.isSameNode&&c.isSameNode(u)){c=l,u=a;continue e}i=_(u);var f=u.nodeType,d=void 0;if(f===c.nodeType&&(1===f?(r?r!==i&&((s=E[r])?u.nextSibling===s?d=!1:(e.insertBefore(s,u),a=u.nextSibling,i?x(i):S(u,e,!0),u=s):d=!1):i&&(d=!1),(d=!1!==d&&U(u,c))&&L(u,c)):3!==f&&8!=f||(d=!0,u.nodeValue!==c.nodeValue&&(u.nodeValue=c.nodeValue))),d){c=l,u=a;continue e}i?x(i):S(u,e,!0),u=a}if(r&&(s=E[r])&&U(s,c))e.appendChild(s),L(s,c);else{var p=g(c);!1!==p&&(p&&(c=p),c.actualize&&(c=c.actualize(e.ownerDocument||M)),e.appendChild(c),T(c))}c=l,u=a}for(;u;)a=u.nextSibling,(i=_(u))?x(i):S(u,e,!0),u=a}var h=V[e.nodeName];h&&h(e,t)}}!function e(t){if(1===t.nodeType)for(var n=t.firstChild;n;){var i=_(n);i&&(E[i]=n),e(n),n=n.nextSibling}}(m);var c,u,f=m,d=f.nodeType,p=v.nodeType;if(!s)if(1===d)1===p?U(m,v)||(l(m),f=function(e,t){for(var n=e.firstChild;n;){var i=n.nextSibling;t.appendChild(n),n=i}return t}(m,(c=v.nodeName,(u=v.namespaceURI)&&u!==O?M.createElementNS(u,c):M.createElement(c)))):f=v;else if(3===d||8===d){if(p===d)return f.nodeValue!==v.nodeValue&&(f.nodeValue=v.nodeValue),f;f=v}if(f===v)l(m);else if(L(f,v,s),o)for(var h=0,C=o.length;h<C;h++){var A=E[o[h]];A&&S(A,A.parentNode,!1)}return!s&&f!==m&&m.parentNode&&(f.actualize&&(f=f.actualize(m.ownerDocument||M)),m.parentNode.replaceChild(f,m)),f});t.exports=o},{}],13:[function(e,t,n){var r=function(e){return document.getElementById(e)};n.getId=r;var i=function(e,t){for(var n=t.firstChild;null!==n;n=n.nextSibling)e.push(n),n.hasChildNodes()&&i(e,n)};n.loopChilds=i,n.testEvent=function(e){return/ k-/.test(e)},n.checkNodeAvailability=function(e,t,n){var i=r(e.el);if(i)return i;var o=setInterval(function(){(i=r(e.el))&&(clearInterval(o),n(e,t,i))},0);setTimeout(function(){clearInterval(o)},250)},n.assert=function(e,t){if(!e)throw Error("(keet) "+t)},n.html=function(){var e=[].shift.call(arguments).raw,t=e[e.length-1];return t=(t=t.split(/\n+/)).map(function(e){return e.trim()}).join("")},n.createModel=function(){var t=[];function i(){for(var e=t.length;e--;)t[e](n)}var n={list:[],subscribe:function(e){return t.push(e)},add:function(e){this.list=this.list.concat(e),i()},update:function(t,n){this.list=this.list.map(function(e){return e[t]!==n[t]?e:Object.assign(e,n)}),i()},destroy:function(t,n){this.list=this.list.filter(function(e){return e[t]!==n}),i()}};return n}},{}]},{},[11])(11)});
/**
 * Keetjs v4.0.0 Alpha release: https://github.com/keetjs/keet.js
 * Minimalist view layer for the web
 *
 * <<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Keetjs >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
 *
 * Copyright 2018, Shahrul Nizam Selamat
 * Released under the MIT License.
 */
